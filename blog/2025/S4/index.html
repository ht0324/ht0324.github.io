<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Efficiently Modeling Long Sequences with Structured State Spaces (S4) – Review | Hun Tae Kim</title> <meta name="author" content="Hun Tae Kim"> <meta name="description" content="Reviewing the S4 paper—structured state-space models, HiPPO initialization, and what makes it work for long sequences"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Source+Sans+3:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400;1,600&amp;family=Source+Serif+4:ital,opsz,wght@0,8..60,400;0,8..60,500;0,8..60,600;0,8..60,700;1,8..60,400;1,8..60,600&amp;display=swap"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%9A%80&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://ht0324.github.io/blog/2025/S4/"> </head> <body class="fixed-top-nav " style="overflow-x: hidden; max-width: 100vw;"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title" href="/">Hun Tae Kim</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/Links/">Links</a> </li> <li class="nav-item "> <a class="nav-link" href="/CV/">CV</a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" style="overflow-x: hidden;"> <div class="post"> <header class="post-header"> <h1 class="post-title">Efficiently Modeling Long Sequences with Structured State Spaces (S4) – Review</h1> <div class="post-meta-wrapper"> <span> <i class="fas fa-calendar fa-sm"></i> February 9, 2025 </span> </div> <div class="post-tag-wrapper"> <a href="/blog/tag/ai" class="tag-pill"> <i class="fas fa-hashtag fa-sm"></i> AI</a> <a href="/blog/category/paper" class="tag-pill"> <i class="fas fa-folder fa-sm"></i> Paper</a> </div> </header> <article class="post-content"> <div id="markdown-content"> <p>This time, I’ll talk about the paper <a href="https://arxiv.org/abs/2111.00396" rel="external nofollow noopener" target="_blank">“Efficiently Modeling Long Sequences with Structured State Spaces”</a>, also known as S4. This paper introduces a state-space model (SSM) called Structured State Space (S4) to effectively handle long-range dependencies in sequence modeling tasks.</p> <p>S4 utilizes a new parameterization approach that significantly improves computational efficiency, allowing it to handle extremely long sequences (over 10,000 steps). Its design relies on state-space models that have existed for decades in control theory, but with clever mathematical insights that make it suitable for modern deep learning.</p> <hr> <h3 id="key-concepts">Key Concepts</h3> <p><strong>State-Space Models (SSM)</strong><br> State-space models describe a dynamic system through a latent state (<code class="language-plaintext highlighter-rouge">x_t</code>) evolving over time in response to inputs (<code class="language-plaintext highlighter-rouge">u_t</code>). The output (<code class="language-plaintext highlighter-rouge">y_t</code>) is generated based on the current state. Formally, an SSM looks like this:</p> <ul> <li>Continuous form: <ul> <li>State update: x’(t) = A * x(t) + B * u(t)</li> <li>Output: y(t) = C * x(t) + D * u(t)</li> </ul> </li> <li>Discrete form (used in computation): <ul> <li>x[t+1] = A_d * x[t] + B_d * u[t]</li> <li>y[t] = C_d * x[t] + D_d * u[t]</li> </ul> </li> </ul> <p>The latent state captures the “memory” of the system, making SSMs particularly good at modeling sequences with long-range dependencies.</p> <p><strong>Structured State Space (S4)</strong><br> The main idea behind S4 is that previous SSM implementations were computationally impractical for long sequences. The authors propose a structured approach by decomposing the crucial state-transition matrix <code class="language-plaintext highlighter-rouge">A</code> into a normal matrix plus a low-rank correction. This approach simplifies computation and makes the model highly efficient.</p> <p><strong>HiPPO Initialization</strong><br> The HiPPO (High-order Polynomial Projection Operator) matrix is a specially designed matrix used to initialize the state-transition matrix <code class="language-plaintext highlighter-rouge">A</code>. It’s structured to maintain long-term memory effectively by projecting past sequence information onto orthogonal polynomials (specifically Legendre polynomials). This ensures stability and controlled memory decay for capturing long-range dependencies.</p> <p><strong>Convolutional Representation</strong><br> SSMs can also be represented as convolutions. By “unrolling” the state equations, the output at any time step can be computed as a convolution of inputs with a kernel defined by <code class="language-plaintext highlighter-rouge">A</code>. This convolutional perspective is computationally advantageous, particularly when diagonalizing the state matrix is feasible.</p> <hr> <h3 id="key-takeaways-what-i-learned">Key Takeaways (What I Learned)</h3> <p><strong>Why the Gaussian Assumption is Important</strong><br> Initially, I wondered why state-space models often assume Gaussian noise. The Gaussian assumption makes things mathematically convenient. It allows closed-form solutions (like Kalman filters) and leverages the Central Limit Theorem. Without this assumption, things become mathematically tricky and less predictable.</p> <p><strong>Why Discretization Matters</strong><br> Real-world data isn’t continuous—it’s sampled at discrete intervals. S4 discretizes the continuous equations to match this reality. At first, this seemed trivial, but it’s crucial because discrete forms (<code class="language-plaintext highlighter-rouge">\bar{A}</code>, <code class="language-plaintext highlighter-rouge">\bar{B}</code>, etc.) differ significantly from their continuous counterparts. This discretization isn’t arbitrary; it strongly influences the model’s stability and computational efficiency.</p> <p><strong>The Role of the A Matrix</strong><br> I initially struggled to understand why the <code class="language-plaintext highlighter-rouge">A</code> matrix is so central. After digging deeper, I realized <code class="language-plaintext highlighter-rouge">A</code> controls the internal dynamics or “memory” of the system. Its eigenvalues determine whether information fades out quickly (short memory) or persists longer (long memory). The genius of S4 is in carefully structuring <code class="language-plaintext highlighter-rouge">A</code> to maintain stability, ensuring the system can capture long-term dependencies without exploding or collapsing to zero.</p> <p><strong>HiPPO Isn’t Just a Fancy Name</strong><br> The paper frequently mentions HiPPO initialization, and I initially felt it was vague. The deeper reason HiPPO works is that it ensures the <code class="language-plaintext highlighter-rouge">A</code> matrix has eigenvalues that stay stable (within the unit circle). By projecting sequence history onto stable polynomial bases, HiPPO explicitly provides controlled memory behavior. This isn’t just an initialization trick—it’s the core reason S4 effectively handles long sequences.</p> <p><strong>Normality and Stability</strong><br> Another subtlety was why the normality of the <code class="language-plaintext highlighter-rouge">A</code> matrix matters. Normal matrices can be cleanly diagonalized (eigenvalues neatly organized along a diagonal matrix). This diagonalization directly influences the system’s memory properties because eigenvalues neatly describe the decay of information. Non-normal matrices lack this clean representation, leading to unstable or unpredictable behaviors over long sequences.</p> <p><strong>How Does S4 Compare to Other Models?</strong><br> Compared to conventional sequence models like RNNs, CNNs, or even Transformers, S4 captures long-range dependencies more effectively and efficiently. This efficiency comes from its structured <code class="language-plaintext highlighter-rouge">A</code> matrix and convolutional form. Interestingly, S4 doesn’t need special tricks (like dilations or gating mechanisms) that other architectures use. It’s a straightforward yet powerful alternative.</p> <hr> <h3 id="summary--final-thoughts">Summary &amp; Final Thoughts</h3> <p>S4 is essentially a state-space model optimized for deep learning, specifically tackling the problem of modeling long-range dependencies. The authors solve the key computational challenges by cleverly structuring the <code class="language-plaintext highlighter-rouge">A</code> matrix and using HiPPO initialization for stability. The resulting model efficiently processes extremely long sequences while maintaining high accuracy across diverse tasks.</p> <p>Personally, the biggest revelation was how well-established mathematical concepts (like state-space models and polynomial projections) can be combined cleverly to solve practical, modern deep learning problems. Understanding S4 gave me deeper insights into what truly makes sequence models “remember” or “forget,” and how careful mathematical design can outperform brute-force approaches.</p> </div> </article><div id="giscus_thread" style="max-width: 800px; margin: 0 auto;"> <script>let giscusTheme=localStorage.getItem("theme"),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"ht0324/ht0324.github.io","data-repo-id":"","data-category":"Comments","data-category-id":"","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Hun Tae Kim. All Rights Reserved. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-7ZMBS6JQKV"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-7ZMBS6JQKV");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>