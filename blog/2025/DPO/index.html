<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title>Direct Preference Optimization (DPO) - Review | Hun Tae Kim</title> <meta name="author" content="Hun Tae Kim"> <meta name="description" content="Reviewing DPO, a simpler way to fine-tune language models to human preferences without explicitly modeling rewards"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css2?family=Source+Sans+3:ital,wght@0,300;0,400;0,500;0,600;0,700;1,400;1,600&amp;family=Source+Serif+4:ital,opsz,wght@0,8..60,400;0,8..60,500;0,8..60,600;0,8..60,700;1,8..60,400;1,8..60,600&amp;display=swap"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?19f3075a2d19613090fe9e16b564e1fe" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%9A%80&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://ht0324.github.io/blog/2025/DPO/"> </head> <body class="fixed-top-nav " style="overflow-x: hidden; max-width: 100vw;"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title" href="/">Hun Tae Kim</a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About</a> </li> <li class="nav-item active"> <a class="nav-link" href="/blog/">Blog<span class="sr-only">(current)</span></a> </li> <li class="nav-item "> <a class="nav-link" href="/Links/">Links</a> </li> <li class="nav-item "> <a class="nav-link" href="/CV/">CV</a> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" style="overflow-x: hidden;"> <div class="post"> <header class="post-header"> <h1 class="post-title">Direct Preference Optimization (DPO) - Review</h1> <div class="post-meta-wrapper"> <span> <i class="fas fa-calendar fa-sm"></i> February 17, 2025 </span> </div> <div class="post-tag-wrapper"> <a href="/blog/tag/ai" class="tag-pill"> <i class="fas fa-hashtag fa-sm"></i> AI</a> <a href="/blog/category/paper" class="tag-pill"> <i class="fas fa-folder fa-sm"></i> Paper</a> </div> </header> <article class="post-content"> <div id="markdown-content"> <p>In this post, I’ll share my thoughts on the paper <a href="https://arxiv.org/abs/2305.18290" rel="external nofollow noopener" target="_blank"><em>Direct Preference Optimization: Your Language Model is Secretly a Reward Model</em></a>, usually called DPO. This paper is interesting because it approaches the widely used Reinforcement Learning with Human Feedback (RLHF) paradigm in a fundamentally simpler way.</p> <p>The paper starts with the motivation behind alignment: aligning language models (LMs) with human preferences. Existing methods like PPO-based RLHF are effective but notoriously complex and unstable. DPO aims to simplify this by cleverly rethinking how reward modeling and preference alignment can be done.</p> <p>Let’s dive in.</p> <hr> <h3 id="key-concepts">Key Concepts</h3> <p><strong>Direct Preference Optimization (DPO)</strong><br> DPO removes the explicit reward modeling step that’s common in RLHF. Instead of first training a separate reward model and then using RL to maximize that reward, DPO cleverly formulates the reward implicitly within the language model itself. This allows solving the alignment problem using a simple supervised classification objective.</p> <p><strong>Bradley-Terry Model</strong><br> DPO builds upon the Bradley-Terry model, a statistical approach for estimating the probability that one option is preferred over another. While it initially seemed random that they picked such an old statistical model, it’s been used previously by OpenAI and DeepMind in RL settings. The Bradley-Terry formula gives an intuitive probability distribution over preferences, making it suitable for learning from human feedback.</p> <p><strong>Implicit Reward Representation</strong><br> The key insight in DPO is that the “reward” for a given output can be represented implicitly as the log ratio of the probabilities from the learned LM and a reference LM (usually the SFT or supervised fine-tuned model). Instead of explicitly modeling rewards, DPO directly optimizes this ratio to reflect human preferences.</p> <p><strong>Simplified Objective (No RL Required)</strong><br> By using the implicit reward representation, DPO turns preference alignment into a supervised learning problem. The objective is simply to increase the probability of preferred outputs and decrease the probability of non-preferred ones, scaled by a weighting term reflecting confidence in the model’s preference ranking.</p> <hr> <h3 id="key-takeaways-what-i-learned">Key Takeaways (What I Learned)</h3> <p><strong>Removing the Explicit Reward Model is Clever</strong><br> Initially, I thought the explicit reward model was essential to RLHF. It seemed natural: first learn rewards from humans, then optimize those rewards. DPO surprised me by showing you can skip that step completely. Instead of explicitly modeling human preferences, DPO encodes them directly into the language model’s probabilities. It’s neat, elegant, and way simpler.</p> <p><strong>The Bradley-Terry Model as the Theoretical Foundation</strong><br> At first glance, the Bradley-Terry model felt arbitrary to me—it’s a decades-old statistical model, after all. But its use in RLHF contexts actually dates back to earlier work by OpenAI and DeepMind. Bradley-Terry is intuitive because it translates pairwise human preference data directly into probabilities. DPO smartly leverages this model to avoid more complicated RL setups.</p> <p><strong>DPO’s Loss Function Explained</strong><br> The loss function in DPO initially confused me because of its signs and terms. However, the intuition eventually clicked: it increases the likelihood of preferred outputs and decreases the likelihood of dispreferred ones. Crucially, the loss is weighted by how “wrong” the model is about these preferences. If the model is confident but incorrect, it makes larger corrections. This weighting makes the optimization stable and effective.</p> <p><strong>Why Stability is Important (and How DPO Ensures it)</strong><br> Standard RLHF methods like PPO often become unstable because they rely on explicit reward models and require careful tuning. DPO bypasses this by using a fixed reference model (usually the SFT model). By avoiding explicit reward estimation and complicated online updates, DPO remains stable, even as the model improves.</p> <p><strong>Surprising Performance Without Complex Tuning</strong><br> The experimental results clearly showed that DPO achieves comparable or better performance compared to traditional RLHF methods. What was most surprising to me was that DPO achieves high alignment quality without requiring extensive hyperparameter tuning or complex reward sampling procedures. It simplifies the process dramatically.</p> <p><strong>Philosophical Shift: Overfitting vs. Generalization</strong><br> An interesting aspect of DPO (and similar recent methods like ORPO) is that it operates entirely offline. Unlike traditional RL methods, which involve interactive environments and trajectories, DPO treats preference alignment purely as supervised learning. It’s a philosophical shift from generalization towards targeted optimization or even intentional overfitting to human preferences. It made me rethink what RLHF truly means.</p> <p><strong>KL Divergence and Model Drift</strong><br> I found the authors’ point about KL divergence important but not fully explained in the paper. DPO achieves high alignment quality without significant drift from the original supervised fine-tuned (SFT) model. This matters because extensive drift can degrade other aspects of the model, such as coherence or factual accuracy. Staying close to the original SFT model helps maintain overall quality.</p> <hr> <h3 id="some-things-that-were-initially-confusing">Some Things That Were Initially Confusing</h3> <ul> <li> <strong>The leap in equation (4)</strong>: I struggled at first to understand how they substituted the optimal policy into their objective so cleanly. It made perfect sense mathematically afterward, but felt like a creative jump rather than an obvious derivation.</li> <li> <strong>Weighted gradient interpretation</strong>: Initially, the weighting term in the gradient was counterintuitive due to signs. Eventually, I understood it as correcting more strongly when the model’s implicit reward ordering is confidently wrong.</li> <li> <strong>KL Divergence Interpretation</strong>: It wasn’t clear to me initially why minimizing KL divergence from the reference (initial) policy is inherently desirable. Later I understood it prevents excessive drift from a stable baseline, which preserves other desirable model properties.</li> </ul> <hr> <h3 id="summary--final-thoughts">Summary &amp; Final Thoughts</h3> <p>DPO simplifies RLHF dramatically by removing the explicit reward modeling step, making fine-tuning easier, more stable, and faster. Although it’s not strictly reinforcement learning in a traditional sense (it lacks online updates and explicit reward signals), it captures the essence of aligning models to human preferences in a cleaner and more accessible way.</p> <p>The simplicity and clarity of DPO’s core idea—implicitly encoding rewards directly into language models—makes it very appealing. While it’s not the only method (ORPO takes this even further), DPO is an insightful approach that significantly reduces complexity without sacrificing quality.</p> <p>Overall, it’s a valuable reminder that sometimes the best advances come not from adding complexity, but from cleverly stripping it away.</p> </div> </article><div id="giscus_thread" style="max-width: 800px; margin: 0 auto;"> <script>let giscusTheme=localStorage.getItem("theme"),giscusAttributes={src:"https://giscus.app/client.js","data-repo":"ht0324/ht0324.github.io","data-repo-id":"","data-category":"Comments","data-category-id":"","data-mapping":"title","data-strict":"1","data-reactions-enabled":"1","data-emit-metadata":"0","data-input-position":"bottom","data-theme":giscusTheme,"data-lang":"en",crossorigin:"anonymous",async:""},giscusScript=document.createElement("script");Object.entries(giscusAttributes).forEach(([t,e])=>giscusScript.setAttribute(t,e)),document.getElementById("giscus_thread").appendChild(giscusScript);</script> <noscript>Please enable JavaScript to view the <a href="http://giscus.app/?ref_noscript" rel="external nofollow noopener" target="_blank">comments powered by giscus.</a> </noscript> </div> </div> </div> <footer class="fixed-bottom"> <div class="container mt-0"> © Copyright 2025 Hun Tae Kim. All Rights Reserved. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?7b30caa5023af4af8408a472dc4e1ebb"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?d633890033921b33e0ceb13d22340a9c"></script> <script defer src="/assets/js/common.js?acdb9690d7641b2f8d40529018c71a01"></script> <script defer src="/assets/js/copy_code.js?c9d9dd48933de3831b3ee5ec9c209cac" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script async src="https://www.googletagmanager.com/gtag/js?id=G-7ZMBS6JQKV"></script> <script>function gtag(){window.dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","G-7ZMBS6JQKV");</script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>